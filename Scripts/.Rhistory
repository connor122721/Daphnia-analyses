theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18),
legend.position = "none")
# Read in psmc output
data <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf2.csv")))
# Metadata sample file
samps <- fread("C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/cloneinfo.txt")
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex" & medrd > 15))
# Merge metadata info
data$clone <- str_replace_all(data$name, pattern=".psmc", replacement="")
data <- data.table(merge(data, samps %>% select(SC, clone, population, year), by = "clone"))
unique(data$clone)
# Summary output
ggplot(data[years > 1e3], aes(x=years, y=eff, color=SC, group=clone)) +
geom_step(alpha=0.4) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18),
legend.position = "none")
# Read in psmc output
data <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf2.csv")))
# Metadata sample file
samps <- fread("C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/cloneinfo.txt")
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex"))
# Merge metadata info
data$clone <- str_replace_all(data$name, pattern=".psmc", replacement="")
data <- data.table(merge(data, samps %>% select(SC, clone, population, year), by = "clone"))
unique(data$clone)
# Summary output
ggplot(data[years > 1e3], aes(x=years, y=eff, color=SC, group=clone)) +
geom_step(alpha=0.4) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18),
legend.position = "none")
# Read in psmc output
data <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf1.csv")))
# Metadata sample file
samps <- fread("C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/cloneinfo.txt")
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex"))
# Merge metadata info
data$clone <- str_replace_all(data$name, pattern=".psmc", replacement="")
data <- data.table(merge(data, samps %>% select(SC, clone, population, year), by = "clone"))
unique(data$clone)
# Summary output
ggplot(data[years > 1e3], aes(x=years, y=eff, color=SC, group=clone)) +
geom_step(alpha=0.4) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18),
legend.position = "none")
# Libraries
library(foreach)
library(data.table)
library(tidyverse)
library(rjson)
# Read in psmc output
data <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/smcpp/smcpp.out5.csv")))
unique(data$clone)
# Metadata sample file
samps <- fread("C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/cloneinfo.txt")
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex"))
# Merge metadata info
data <- data.table(merge(data, samps %>% select(SC, clone, population, year), by = "clone"))
# Summary output
ggplot(data[x>1000 & x<1e6], aes(x=x, y=y, color=SC, group=clone)) +
stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
#geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18),
legend.position = "none")
# Summary output
ggplot(data[x>1000 & x<1e5], aes(x=x, y=y, color=SC, group=clone)) +
stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
#geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18),
legend.position = "none")
# Summary output
ggplot(data[x>1000 & x<1e5], aes(x=x, y=y, color=SC, group=clone)) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18),
legend.position = "none")
# Read in psmc output
data <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/smcpp/smcpp.out5.csv")))
# Metadata sample file
samps <- fread("C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/cloneinfo.txt")
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex"))
# Merge metadata info
data <- data.table(merge(data, samps %>% select(SC, clone, population, year), by = "clone"))
# Read in psmc output
ps <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf1.csv")))
# Metadata sample file
samps <- fread("C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/cloneinfo.txt")
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex"))
# Merge metadata info
ps$clone <- str_replace_all(ps$name, pattern=".psmc", replacement="")
ps <- data.table(merge(ps, samps %>% select(SC, clone, population, year), by = "clone"))
# Read in psmc output
data <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/smcpp/smcpp.out5.csv")))
# Metadata sample file
samps <- fread("C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/cloneinfo.txt")
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex"))
# Merge metadata info
data <- data.table(merge(data, samps %>% select(SC, clone, population, year), by = "clone"), data="smc++")
# Read in psmc output
ps <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf1.csv")))
View(data)
# Read in psmc output
ps <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf1.csv")))
# Merge metadata info
ps$clone <- str_replace_all(ps$name, pattern=".psmc", replacement="")
ps <- data.table(merge(ps, samps %>% select(SC, clone, population, year), by = "clone"), data="psmc")
View(ps)
View(data)
# Merge SMC++ & PSMC
tot <- data.table(merge(ps, data, by = "clone"))
# Merge SMC++ & PSMC
tot <- data.table(rbind(ps, data, by = "clone"))
View(ps)
View(data)
View(ps)
View(data)
View(ps)
# Read in psmc output
data <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/smcpp/smcpp.out5.csv")))
# Metadata sample file
samps <- fread("C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/cloneinfo.txt")
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex"))
# Merge metadata info
data <- data.table(merge(data, samps %>% select(SC, clone, population, year), by = "clone"), data="smc++")
# Read in psmc output
ps <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf1.csv")))
# Merge metadata info
ps$clone <- str_replace_all(ps$name, pattern=".psmc", replacement="")
ps <- data.table(merge(ps, samps %>% select(SC, clone, population, year), by = "clone"), data="psmc")
# Merge SMC++ & PSMC
tot <- data.table(rbind(ps %>% select(clone, years, eff, data, SC, year, population),
data  %>% select(clone, years, eff, data, SC, year, population), by = "clone"))
data  %>% select(clone, years, eff, data, SC, year, population)
ps %>% select(clone, years, eff, data, SC, year, population)
rbind(ps %>% select(clone, years, eff, data, SC, year, population),
data  %>% select(clone, years, eff, data, SC, year, population)
)
# Merge SMC++ & PSMC
tot <- data.table(rbind(ps %>% select(clone, years, eff, data, SC, year, population),
data  %>% select(clone, years, eff, data, SC, year, population)))
data <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/smcpp/smcpp.out5.csv")))
# Metadata sample file
samps <- fread("C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/cloneinfo.txt")
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex"))
# Merge metadata info
data <- data.table(merge(data, samps %>% select(SC, clone, population, year), by = "clone"), data="smc++")
# Read in psmc output
ps <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf1.csv")))
# Merge metadata info
ps$clone <- str_replace_all(ps$name, pattern=".psmc", replacement="")
ps <- data.table(merge(ps, samps %>% select(SC, clone, population, year), by = "clone"), data="psmc")
# Merge SMC++ & PSMC
tot <- data.table(rbind(ps %>% select(clone, years, eff, data, SC, year, population),
data  %>% select(clone, years, eff, data, SC, year, population)))
View(tot)
# Summary output
ggplot(tot[years>1000 & years<1e5], aes(x=x, y=y, color=data, group=clone)) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18),
legend.position = "none")
# Summary output
ggplot(tot[years>1000 & years<1e5], aes(x=years, y=eff, color=data, group=clone)) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18),
legend.position = "none")
# Summary output
ggplot(tot[years>1000 & years<1e5][SC=="A"], aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18),
legend.position = "none")
# Summary output
ggplot(tot[years>1000 & years<1e5], aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
#geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18),
legend.position = "none")
# Read in psmc output
data <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/smcpp/smcpp.out5.csv")))
# Metadata sample file
samps <- fread("C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/cloneinfo.txt")
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex"))
# Merge metadata info
data <- data.table(merge(data, samps %>% select(SC, clone, population, year), by = "clone"), data="smc++")
# Read in psmc output
ps <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf1.csv")))
# Merge metadata info
ps$clone <- str_replace_all(ps$name, pattern=".psmc", replacement="")
ps <- data.table(merge(ps, samps %>% select(SC, clone, population, year), by = "clone"), data="psmc/Bed")
ps2 <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf2.csv")))
# Merge metadata info
ps2$clone <- str_replace_all(ps2$name, pattern=".psmc", replacement="")
ps2 <- data.table(merge(ps, samps %>% select(SC, clone, population, year), by = "clone"), data="psmc")
# Merge SMC++ & PSMC
tot <- data.table(rbind(ps %>% select(clone, years, eff, data, SC, year, population),
ps2 %>% select(clone, years, eff, data, SC, year, population),
data  %>% select(clone, years, eff, data, SC, year, population)))
View(ps2)
View(ps)
ps2 <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf2.csv")))
# Merge metadata info
ps2$clone <- str_replace_all(ps2$name, pattern=".psmc", replacement="")
# Read in psmc output
data <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/smcpp/smcpp.out5.csv")))
# Metadata sample file
samps <- fread("C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/cloneinfo.txt")
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex"))
# Merge metadata info
data <- data.table(merge(data, samps %>% select(SC, clone, population, year), by = "clone"), data="smc++")
# Read in psmc output
ps <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf1.csv")))
# Merge metadata info
ps$clone <- str_replace_all(ps$name, pattern=".psmc", replacement="")
ps <- data.table(merge(ps, samps %>% select(SC, clone, population, year), by = "clone"), data="psmc/Bed")
ps2 <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf2.csv")))
# Merge metadata info
ps2$clone <- str_replace_all(ps2$name, pattern=".psmc", replacement="")
ps2 <- data.table(merge(ps2, samps %>% select(SC, clone, population, year), by = "clone"), data="psmc")
# Merge SMC++ & PSMC
tot <- data.table(rbind(ps %>% select(clone, years, eff, data, SC, year, population),
ps2 %>% select(clone, years, eff, data, SC, year, population),
data  %>% select(clone, years, eff, data, SC, year, population)))
# Summary output
ggplot(tot[years>1000 & years<1e5][SC=="A"], aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18),
legend.position = "none")
# Summary output
ggplot(tot[years>1000 & years<1e5][SC=="A"], aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18))
# Summary output
ggplot(tot[years>1000 & years<1e5][SC=="A"][eff < 1e6], aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18))
# Summary output
ggplot(tot[years>1000 & years<1e5][SC=="A"][eff < 9e5], aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18))
# Summary output
ggplot(tot[years>1000 & years<1e5][SC=="A"][eff<7e5], aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18))
# Summary output
ggplot(tot[years>1000 & years<1e5][SC=="A"][eff<7e5], aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
#geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18))
ggplot(tot[years>1000 & years<1e5][SC=="A"][eff<7e5], aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4)
# Summary output
ggplot(tot[years>1000 & years<1e5][SC=="A"][eff<7e5],
aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18))
# Summary output
ggplot(tot[years>1000 & years<1e5][SC=="A"][eff<5e5], aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18))
# Read in psmc output
data <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/smcpp/smcpp.out5.csv")))
# Metadata sample file
samps <- fread("C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/cloneinfo.txt")
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex" & medrd > 20))
# Merge metadata info
data <- data.table(merge(data, samps %>% select(SC, clone, population, year), by = "clone"), data="smc++")
# Read in psmc output
ps <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf1.csv")))
# Merge metadata info
ps$clone <- str_replace_all(ps$name, pattern=".psmc", replacement="")
ps <- data.table(merge(ps, samps %>% select(SC, clone, population, year), by = "clone"), data="psmc/Bed")
ps2 <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf2.csv")))
# Merge metadata info
ps2$clone <- str_replace_all(ps2$name, pattern=".psmc", replacement="")
ps2 <- data.table(merge(ps2, samps %>% select(SC, clone, population, year), by = "clone"), data="psmc")
# Merge SMC++ & PSMC
tot <- data.table(rbind(ps %>% select(clone, years, eff, data, SC, year, population),
ps2 %>% select(clone, years, eff, data, SC, year, population),
data  %>% select(clone, years, eff, data, SC, year, population)))
# Summary output
ggplot(tot[years>1000 & years<1e5][SC=="A"], aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18))
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex" & medrd > 12))
# Read in psmc output
data <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/smcpp/smcpp.out5.csv")))
# Metadata sample file
samps <- fread("C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/cloneinfo.txt")
samps <- data.table(samps %>% filter(Nonindependent==0 & is.na(LowReadDepth) & Species=="pulex" & medrd > 12))
# Merge metadata info
data <- data.table(merge(data, samps %>% select(SC, clone, population, year), by = "clone"), data="smc++")
# Read in psmc output
ps <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf1.csv")))
# Merge metadata info
ps$clone <- str_replace_all(ps$name, pattern=".psmc", replacement="")
ps <- data.table(merge(ps, samps %>% select(SC, clone, population, year), by = "clone"), data="psmc/Bed")
ps2 <- data.table(na.omit(read.csv(file = "C:/Users/Conno/Desktop/Fall2020/Berglandlab/Data/psmc.vcf2.csv")))
# Merge metadata info
ps2$clone <- str_replace_all(ps2$name, pattern=".psmc", replacement="")
ps2 <- data.table(merge(ps2, samps %>% select(SC, clone, population, year), by = "clone"), data="psmc")
# Merge SMC++ & PSMC
tot <- data.table(rbind(ps %>% select(clone, years, eff, data, SC, year, population),
ps2 %>% select(clone, years, eff, data, SC, year, population),
data  %>% select(clone, years, eff, data, SC, year, population)))
# Summary output
ggplot(tot[years>1000 & years<1e5][SC=="A"], aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18))
# Summary output
ggplot(tot[years>1000 & years<1e5], aes(x=years, y=eff, color=data, group=interaction(clone, data))) +
# stat_smooth(geom='line', alpha=0.5, se=FALSE, span = 0.4) +
geom_step(alpha=0.5) +
facet_wrap(~SC) +
scale_x_log10() +
scale_y_log10() +
annotation_logticks(scaled = TRUE) +
labs(x="Years (log10)", y="Ne (log10)") +
theme_classic() +
theme(axis.text.x = element_text(face="bold", size=16),
axis.text.y = element_text(face="bold", size=16),
axis.title.x = element_text(face="bold", size=18),
axis.title.y = element_text(face="bold", size=18))
